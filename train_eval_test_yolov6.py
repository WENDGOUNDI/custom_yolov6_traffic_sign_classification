# -*- coding: utf-8 -*-
"""train_eval_test_yolov6.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1_ZiPyTsQbcnJNXlqpZ5qSrKT7T6gx_so
"""

# Connect to google colab

from google.colab import drive
drive.mount('/content/drive')

# Move to the Yolov6 main folder
cd /content/drive/MyDrive/DL/Object_Detection/YOLOv6-main

# list the Yolov6 main folder element
ls

# Install the necessary libraries

!pip install -r requirements.txt

# Import torch library and check the availabilty of a GPU.
# Here I a using Google Colab Tesla T4 GPU

import torch
torch.cuda.is_available() 
torch.cuda.get_device_name(0)

"""Training step"""

!python tools/train.py --batch 16 --conf configs/yolov6s_finetune.py --data-path dataset.yaml --device 0 --epochs 10 --eval-interval 2

"""**Evaluation Step**"""

!python tools/eval.py --data dataset.yaml  --weights runs/train/exp14/weights/best_ckpt.pt --device 0

"""Test the trained model"""

!python tools/infer.py --weights runs/train/exp14/weights/best_ckpt.pt --source /content/drive/MyDrive/DL/Object_Detection/YOLOv6-main/data/images/test/00894.jpg --yaml dataset.yaml --device 0